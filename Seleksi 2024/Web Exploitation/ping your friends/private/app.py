from flask import Flask, request, render_template
import subprocess
import socket

app = Flask(__name__)

def valid_ip(address):
    try:
        socket.inet_aton(address)
        return True
    except:
        return False

@app.route('/', methods = ['GET', 'POST'])
def home():
    if request.method == 'POST':
        # validate user input
        usr_input = request.form.get('command')
        if not valid_ip(usr_input.split()[0]):
            return render_template('home.html', cmd_output = "Please input a valid IP Address!".split())
        command = subprocess.Popen(f'ping -c 4 {usr_input}', shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT).stdout.readlines()
        command = [i.decode() for i in command]
        return render_template('home.html', cmd_output = command)
    return render_template('home.html')

app.run(host='0.0.0.0', port=2002)
